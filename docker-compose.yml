version: "3.7"
services:
    api:
        build: 
          context: .
        environment:
            USULROSTER_MONGO_URI: mongodb://database
        env_file:
          - .env
        depends_on:
          - database
        labels:
          - traefik.enable=true
          - traefik.http.routers.usulroster.tls=true
            # Set domain name for your domain
          - traefik.http.routers.usulroster.rule=Host(`or.localhost`)
    database:
        image: mongo
        volumes:
            # Set database directory to non temp folder
            - /tmp/data/db:/data/db
    reverse-proxy:
        image: traefik
        ports:
          - 443:443
        volumes:
          - /var/run/docker.sock:/var/run/docker.sock
          - ./traefik/traefik.toml:/etc/traefik/traefik.toml
            # Add your ssl ,crt and .key files to ./traefik/cert
          - ./traefik/cert:/cert
